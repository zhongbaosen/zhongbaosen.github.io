---
title: CentOS7 安装 Postgresql
date: 2018-3-15 10:16:10
tags: [centos, postgresql]
---

## 安装步骤

### 在yum库里更新postgresql安装包

```bash
rpm  -Uvh  http://yum.postgresql.org/9.5/redhat/rhel-7-x86_64/pgdg-centos95-9.5-2.noarch.rpm
```

```bash
yum  update
```

### 添加RPM
```bash
yum  install  https://download.postgresql.org/pub/repos/yum/9.5/redhat/rhel-7-x86_64/pgdg-centos95-9.5-2.noarch.rpm
```

### 安装postgresql

```bash
yum  install  postgresql95-server  postgresql95-contrib  
```

### 初始化PostgreSQL数据库

```bash
/usr/pgsql-9.5/bin/postgresql95-setup  initdb
```

### 启动PostgreSQL服务并使之开机自启

```bash
systemctl  enable  postgresql-9.5
```

```bash
systemctl  start  postgresql-9.5
```

### 调整Iptables/Firewall，调整防火墙出站规则
```bash
firewall-cmd  --zone=public  --add-port=5432/tcp  --permanent
```

### 重启防火墙
```bash
firewall-cmd  --reload  
```

### 设置用户密码 登陆至postgres命令提示符界面
```bash
su  -  postgres  
```

```bash
psql  
```

### 然后使用命令设置密码
```bash
postgres=#  \password  postgres

        Enter  new  password:

        Enter  it  again:

        postgres=#  \q
      
        su  root

        输入root账号的密码：********
```

### 配置PostgreSQL-MD5认证

MD5认证需要客户端提供一个MD5-encrypted  密码以便身份验证。需要编辑  

```bash
vi  /var/lib/pgsql/9.5/data/pg_hba.conf
```

添加或修改的行如下：

```bash
#  IPv4  local  connections:

host                all            all        127.0.0.1/32            md5

host                all            all        0.0.0.0/0      md5
```

### 配置PostgreSQL-Configure  TCP/IP

默认情况下，TCP/IP连接是不可行的，所以其他计算机用户不能连接到postgresql。

```bash
vi  /var/lib/pgsql/9.5/data/postgresql.conf  #可以允许其他计算机连接。
```

把两行都注析掉并设置为你的postgresql服务器IP地址或设置为“*”监听所有客户端。如下所示：

```bash
listen_addresses  =  '*'

port  =  5432
```

### 重启以应用更改

```bash
systemctl  restart  postgresql-9.5
```
